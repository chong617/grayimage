<!DOCTYPE .html>
<html lang="en">
  <head>
    <title>GrayImage</title>
    <script src="http://www.dukelearntoprogram.com/course1/common/js/image/SimpleImage.js"></script>
    <link rel="stylesheet" type="text/css" href="style.css" />
  </head>
  <body id="center">
    <h1>Upload and Display Image</h1>
    <div class="twocanvas">
      <canvas id="can1"></canvas>
      <canvas id="can2"></canvas>
    </div>
    <section class="typein">
      <label for="press">Filename: </label>
      <input
        type="file"
        mutiple="false"
        accept="image/*"
        id="input"
        onchange="doUpload()"
      />
      <input type="button" value="Make GrayScale" onclick="makeGray()" />
    </section>
    <script>
      var image;
      var grayimage;
      function doUpload() {
        var piccanvas = document.getElementById("can2");
        var imacanvas = document.getElementById("can1");

        var upload = document.getElementById("input");
        image = new SimpleImage(upload);
        grayimage = new SimpleImage(upload);

        image.drawTo(imacanvas);
        grayimage.drawTo(piccanvas);
      }

      function makeGray() {
        for (var pix of grayimage.values()) {
          var avg = (pix.getRed() + pix.getGreen() + pix.getBlue()) / 3;
          pix.setRed(avg);
          pix.setGreen(avg);
          pix.setBlue(avg);
        }
        var piccanvas = document.getElementById("can2");
        grayimage.drawTo(piccanvas);
      }
    </script>
  </body>
</html>
